<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مای‌ده - کشاورزی اهواز</title>
    <style>
        body { font-family: sans-serif; margin: 0; background: #f8fff8; color: #333; }
        header { background: #2e7d32; color: #fff; padding: 1rem; text-align: center; }
        nav { background: #388e3c; padding: .5rem; text-align: center; }
        nav a { color: #fff; margin: 0 1rem; text-decoration: none; }
        .articles-container { margin: 2rem; }
        .article-card { background: #fff; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); padding: 1rem; margin-bottom: 1rem; cursor: pointer; }
        .article-content { display: none; margin-top: .5rem; }
        button { padding: .5rem 1rem; margin: .5rem .2rem; border: none; border-radius: 6px; cursor: pointer; }
        .edit-btn { background: #1976d2; color: #fff; }
        .delete-btn { background: #d32f2f; color: #fff; }
        input, textarea { width: 100%; margin: .5rem 0; padding: .5rem; border-radius: 6px; border: 1px solid #ccc; }
        .weather, .ads, .contact, .add-article, .comments { margin: 2rem; padding: 1rem; border-radius: 12px; background: #fff; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        footer { text-align: center; padding: 1rem; background: #2e7d32; color: #fff; }
    </style>
</head>
<body>
    <header>
        <h1>🌱 مای‌ده - بازارچه کشاورزی اهواز</h1>
    </header>
    <nav>
        <a href="#articles">مقالات</a>
        <a href="#weather">هواشناسی</a>
        <a href="#contact">تماس با ما</a>
    </nav>

    <section class="articles-container" id="articles">
        <h2 style="text-align:center; margin:1rem;">📚 مقالات کشاورزی</h2>
    </section>

    <section class="add-article">
        <h2>➕ افزودن مقاله جدید</h2>
        <input type="text" id="articleTitle" placeholder="عنوان مقاله">
        <textarea id="articleContent" placeholder="متن مقاله"></textarea>
        <button onclick="addArticle()">افزودن</button>
    </section>

    <section class="comments">
        <h2>💬 نظرات</h2>
        <input type="text" id="commentInput" placeholder="نظر خود را بنویسید...">
        <button onclick="addComment()">ارسال نظر</button>
        <div id="commentList"></div>
    </section>

    <section id="weather" class="weather">
        <h2>🌤️ وضعیت هوا</h2>
        <input type="text" id="cityInput" placeholder="نام شهر (فارسی یا انگلیسی)">
        <button onclick="getWeather()">جستجو</button>
        <div id="weatherResult"></div>
    </section>

    <section class="ads">
        <h2>📢 تبلیغات</h2>
        <p>اینجا محل نمایش تبلیغات محصولات محلی و کشاورزی شماست.</p>
    </section>

    <section id="contact" class="contact">
        <h2>📞 تماس با ما</h2>
        <p>واتساپ: <a href="https://wa.me/989332356547">09332356547</a></p>
        <p>تلفن: 09332356547</p>
    </section>

    <footer>
        <p>© 2025 مای‌ده | طراحی ساده و سبز برای کشاورزان اهواز</p>
    </footer>

    <script>
        let articles = [];

        function saveArticles(){
            localStorage.setItem('articles', JSON.stringify(articles));
            renderArticles();
        }

        function renderArticles(){
            const container = document.getElementById('articles');
            container.innerHTML = '<h2 style="text-align:center; margin:1rem;">📚 مقالات کشاورزی</h2>';
            articles.forEach((a,index)=>{
                const card = document.createElement('div');
                card.className = 'article-card';
                card.innerHTML = `<strong>${a.title}</strong>
                                  <div class='article-content'>${a.content}</div>
                                  <button class='edit-btn' onclick='editArticle(${index})'>ویرایش</button>
                                  <button class='delete-btn' onclick='deleteArticle(${index})'>حذف</button>`;
                card.querySelector('strong').onclick = function(){
                    const contentDiv = card.querySelector('.article-content');
                    contentDiv.style.display = contentDiv.style.display==='none'?'block':'none';
                };
                container.appendChild(card);
            });
        }

        function addArticle(){
            const title = document.getElementById('articleTitle').value;
            const content = document.getElementById('articleContent').value;
            if(title && content){
                articles.push({title, content});
                document.getElementById('articleTitle').value='';
                document.getElementById('articleContent').value='';
                saveArticles();
            }
        }

        function editArticle(index){
            const newTitle = prompt('عنوان جدید:', articles[index].title);
            const newContent = prompt('متن جدید:', articles[index].content);
            if(newTitle && newContent){
                articles[index] = {title: newTitle, content: newContent};
                saveArticles();
            }
        }

        function deleteArticle(index){
            if(confirm('آیا مطمئن هستید می‌خواهید حذف کنید؟')){
                articles.splice(index,1);
                saveArticles();
            }
        }

        // بارگذاری مقالات ذخیره شده
        window.onload = function(){
            const saved = localStorage.getItem('articles');
            if(saved){ articles = JSON.parse(saved); }
            renderArticles();
        }

        // نظرات
        function addComment(){
            const input = document.getElementById('commentInput');
            const text = input.value;
            if(text){
                const div = document.createElement('div');
                div.className = 'comment';
                div.textContent = text;
                document.getElementById('commentList').appendChild(div);
                input.value = '';
            }
        }

        // تبدیل جهت باد به نام فارسی
        function degToDir(deg){
            if (deg>=337.5 || deg<22.5) return 'شمال';
            if (deg>=22.5 && deg<67.5) return 'شمال‌شرقی';
            if (deg>=67.5 && deg<112.5) return 'شرق';
            if (deg>=112.5 && deg<157.5) return 'جنوب‌شرقی';
            if (deg>=157.5 && deg<202.5) return 'جنوب';
            if (deg>=202.5 && deg<247.5) return 'جنوب‌غربی';
            if (deg>=247.5 && deg<292.5) return 'غرب';
            if (deg>=292.5 && deg<337.5) return 'شمال‌غربی';
        }

        // هواشناسی با OpenWeatherMap
        async function getWeather(){
            const city = document.getElementById('cityInput').value;
            if(!city) return;
            const apiKey = 'dc9c93f51cdd375d459483c2a9f86d88';
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=fa`;
            const res = await fetch(url);
            const data = await res.json();
            if(data.cod !== 200){
                document.getElementById('weatherResult').innerHTML = '<p>شهر یافت نشد.</p>';
                return;
            }
            const dir = degToDir(data.wind.deg);
            document.getElementById('weatherResult').innerHTML = `
                <p>شهر: ${data.name}</p>
                <p>دمـا: ${data.main.temp}°C</p>
                <p>رطوبت: ${data.main.humidity}%</p>
                <p>باد: ${data.wind.speed} km/h (${dir})</p>
                <p>آسمان: ${data.weather[0].description}</p>
            `;
        }
    </script>
</body>
</html>
